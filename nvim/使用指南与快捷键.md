# Neovim 使用指南与快捷键

## 📋 目录
- [基础概念](#基础概念)
- [核心快捷键](#核心快捷键)
- [文件操作](#文件操作)
- [编辑操作](#编辑操作)
- [窗口管理](#窗口管理)
- [LSP 功能](#lsp-功能)
- [搜索与导航](#搜索与导航)
- [终端使用](#终端使用)
- [Git 操作](#git-操作)
- [常用工作流](#常用工作流)

---

## 🎯 基础概念

### Leader 键

本配置使用 `<Space>` (空格键) 作为 Leader 键。
- `<leader>` 在快捷键中代表空格键
- 例如：`<leader>w` 表示先按空格，再按 `w`

### Vim 模式

- **Normal 模式（普通模式）**：默认模式，用于导航和命令
- **Insert 模式（插入模式）**：用于输入文本，按 `i` 进入
- **Visual 模式（可视模式）**：用于选择文本，按 `v` 进入
- **Command 模式（命令模式）**：输入命令，按 `:` 进入

---

## ⚡ 核心快捷键

### 基本操作

| 快捷键 | 模式 | 功能 | 说明 |
|--------|------|------|------|
| `jk` | Insert | 退出插入模式 | 更方便的 Esc 替代 |
| `<leader>w` | Normal | 保存文件 | 等同于 `:w` |
| `<C-s>` | Normal/Insert/Visual | 保存文件 | 通用保存 |
| `<leader>wq` | Normal | 保存并退出 | 等同于 `:wq` |
| `q` | Normal | 退出当前窗口 | 等同于 `:q` |
| `qq` | Normal | 强制退出 | 等同于 `:q!` |
| `Q` | Normal | 强制退出所有 | 等同于 `:qa!` |
| `;` | Normal | 进入命令模式 | `:` 的替代 |
| `<leader>?` | Normal | 显示快捷键帮助 | 使用 which-key |

### 光标移动增强

| 快捷键 | 模式 | 功能 |
|--------|------|------|
| `<C-u>` | Normal | 向上移动 9 行 |
| `<C-d>` | Normal | 向下移动 9 行 |
| `<C-h>` | Insert | 跳到行首 |
| `<C-l>` | Insert | 跳到行尾 |

---

## 📁 文件操作

### 文件树（nvim-tree）

| 快捷键 | 功能 |
|--------|------|
| `<leader>e` | 打开/关闭文件树 |

**文件树内快捷键：**
- `<CR>` (回车) - 打开文件或展开文件夹
- `o` - 打开文件
- `a` - 创建新文件/文件夹（以 `/` 结尾创建文件夹）
- `d` - 删除文件/文件夹
- `r` - 重命名
- `x` - 剪切
- `c` - 复制
- `p` - 粘贴
- `y` - 复制文件名
- `Y` - 复制相对路径
- `gy` - 复制绝对路径
- `R` - 刷新
- `H` - 显示/隐藏隐藏文件
- `I` - 显示/隐藏 gitignore 文件
- `q` - 关闭文件树

### Buffer 操作

| 快捷键 | 功能 |
|--------|------|
| `<leader>p` | 选择 buffer（交互式） |
| `<leader>x` | 关闭当前 buffer |
| `<leader>X` | 强制关闭当前 buffer |

---

## ✏️ 编辑操作

### 代码补全（blink-cmp）

补全菜单会自动弹出：

| 快捷键 | 功能 |
|--------|------|
| `<Tab>` | 选择下一个补全项 |
| `<S-Tab>` | 选择上一个补全项 |
| `<CR>` | 确认选择 |
| `<C-e>` | 关闭补全菜单 |

### 文本环绕（nvim-surround）

| 命令 | 功能 | 示例 |
|------|------|------|
| `ys{motion}{char}` | 添加环绕 | `ysiw"` - 给当前单词添加引号 |
| `ds{char}` | 删除环绕 | `ds"` - 删除引号 |
| `cs{old}{new}` | 更改环绕 | `cs"'` - 把双引号改为单引号 |
| `yss{char}` | 环绕整行 | `yss)` - 给整行加括号 |

**在 Visual 模式：**
- `S{char}` - 环绕选中文本

**示例：**
```
原文本: hello
操作: ysiw"
结果: "hello"

原文本: "hello"
操作: ds"
结果: hello

原文本: "hello"
操作: cs"'
结果: 'hello'
```

### 快速跳转（flash.nvim）

| 快捷键 | 模式 | 功能 |
|--------|------|------|
| `s` | Normal/Visual | 向前跳转 |
| `S` | Normal/Visual | 向后跳转 |
| `r` | Operator-pending | 远程操作 |
| `R` | Operator-pending/Visual | 树形选择器 |

**使用方法：**
1. 按 `s`
2. 输入要跳转的字符（1-2个）
3. 按高亮标签完成跳转

---

## 🪟 窗口管理

### 窗口导航

| 快捷键 | 功能 |
|--------|------|
| `<C-h>` | 跳转到左侧窗口 |
| `<C-j>` | 跳转到下方窗口 |
| `<C-k>` | 跳转到上方窗口 |
| `<C-l>` | 跳转到右侧窗口 |
| `<leader>c` | 关闭当前窗口 |

### 窗口操作（标准 Vim）

| 命令 | 功能 |
|------|------|
| `:split` 或 `:sp` | 水平分割窗口 |
| `:vsplit` 或 `:vs` | 垂直分割窗口 |
| `<C-w>=` | 均分窗口大小 |
| `<C-w>+` | 增加窗口高度 |
| `<C-w>-` | 减少窗口高度 |
| `<C-w>>` | 增加窗口宽度 |
| `<C-w><` | 减少窗口宽度 |

---

## 🔧 LSP 功能

### Lspsaga 快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `<leader>lr` | 重命名变量 | 重命名符号及所有引用 |
| `<leader>lc` | 代码操作 | 显示可用的代码操作（修复、重构等） |
| `<leader>ld` | 跳转到定义 | 跳转到符号定义处 |
| `<leader>lh` | 显示文档 | 悬停显示文档和类型信息 |
| `<leader>lR` | 查找引用 | 查找符号的所有引用 |
| `<leader>ln` | 下一个诊断 | 跳转到下一个错误/警告 |
| `<leader>lp` | 上一个诊断 | 跳转到上一个错误/警告 |

### Mason（LSP 服务器管理）

```vim
:Mason
```

在 Mason 界面：
- `i` - 安装
- `u` - 更新
- `X` - 卸载
- `q` - 退出

---

## 🔍 搜索与导航

### Telescope（模糊搜索）

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `<leader>f` | 搜索文件名 | 查找项目中的文件 |
| `<leader>F` | 搜索文件内容 | 在文件内容中搜索（live grep） |
| `<leader>ff` | 搜索文件名 | 同 `<leader>f` |
| `<leader>fg` | 搜索字符串 | 同 `<leader>F` |

**Telescope 窗口内快捷键：**
- `<C-j>` - 下一个结果
- `<C-k>` - 上一个结果
- `<C-n>` - 下一个历史
- `<C-p>` - 上一个历史
- `<C-u>` - 预览窗口向上滚动
- `<C-d>` - 预览窗口向下滚动
- `<C-c>` - 关闭 Telescope
- `<CR>` - 打开选中项

### 搜索与替换（grug-far）

```vim
:GrugFar
```

在项目中批量搜索和替换文本。

---

## 💻 终端使用

### 浮动终端（Lspsaga）

| 快捷键 | 模式 | 功能 |
|--------|------|------|
| `<leader>t` | Normal/Insert/Terminal | 打开/关闭浮动终端 |
| `jk` | Terminal | 退出终端插入模式 |
| `<Esc>` | Terminal | 退出终端插入模式 |

### ToggleTerm

| 快捷键 | 模式 | 功能 |
|--------|------|------|
| `<leader>lt` | Normal/Insert/Terminal | 打开/关闭终端 |

### 终端窗口导航

在终端模式下，可以使用以下快捷键在窗口间跳转：
- `<C-h>` - 跳到左侧窗口
- `<C-j>` - 跳到下方窗口
- `<C-k>` - 跳到上方窗口
- `<C-l>` - 跳到右侧窗口

---

## 🔀 Git 操作

本配置集成了 Git 支持，可以在文件树中看到文件的 Git 状态。

### 常用 Git 命令（在终端中）

```bash
# 在浮动终端中使用 Git
<leader>t                    # 打开终端
git status                   # 查看状态
git add .                    # 添加所有更改
git commit -m "message"      # 提交
git push                     # 推送
```

---

## 🎨 常用工作流

### 工作流 1：打开项目

```
1. cd /path/to/project
2. nvim .
3. <leader>e          # 打开文件树
4. <leader>f          # 或者用 Telescope 搜索文件
```

### 工作流 2：编辑文件

```
1. <leader>f          # 搜索并打开文件
2. i                  # 进入插入模式
3. (编辑内容)
4. jk                 # 退出插入模式
5. <leader>w          # 保存
```

### 工作流 3：代码跳转和重构

```
1. 将光标放在函数/变量上
2. <leader>ld         # 跳转到定义
3. <leader>lR         # 查看所有引用
4. <leader>lr         # 重命名（如需要）
5. <C-o>              # 跳回上一个位置
```

### 工作流 4：搜索和替换

```
1. <leader>F          # 在项目中搜索内容
2. (选择文件)
3. :GrugFar           # 批量替换（如需要）
```

### 工作流 5：使用 LSP

```
1. <leader>lh         # 查看函数文档
2. <leader>lc         # 查看可用的代码操作
3. <leader>ln         # 跳转到下一个错误
4. <leader>lc         # 应用修复
```

### 工作流 6：分屏编辑

```
1. :vsplit            # 垂直分割窗口
2. <C-h>/<C-l>       # 在窗口间切换
3. <leader>f          # 在新窗口打开文件
4. <leader>c          # 关闭不需要的窗口
```

---

## 📚 插件功能速查

### UI 相关
- **tokyonight** - 主题配色
- **lualine** - 底部状态栏
- **bufferline** - 顶部 buffer 标签栏
- **nvim-tree** - 文件树
- **which-key** - 快捷键提示
- **dashboard** - 启动页面
- **noice** - 命令行和通知美化
- **indent-blankline** - 缩进线

### 编辑增强
- **nvim-treesitter** - 语法高亮和代码解析
- **blink-cmp** - 代码补全
- **nvim-autopairs** - 自动括号配对
- **nvim-surround** - 快速修改环绕符号
- **flash.nvim** - 快速跳转

### 开发工具
- **telescope** - 模糊搜索
- **mason** - LSP 服务器管理
- **lspsaga** - LSP UI 增强
- **none-ls** - 格式化和 linting
- **avante-nvim** - AI 辅助编程
- **codecompanion** - AI 代码助手

### 语言特定
- **rustaceanvim** - Rust 支持

---

## 🎓 学习建议

### 新手入门顺序

1. **第一天**：掌握基本操作
   - 进入/退出插入模式 (`i`, `jk`)
   - 保存和退出 (`<leader>w`, `q`)
   - 基本移动 (`h`, `j`, `k`, `l`)

2. **第二天**：文件操作
   - 打开文件树 (`<leader>e`)
   - 搜索文件 (`<leader>f`)
   - 切换 buffer (`<leader>p`)

3. **第三天**：窗口管理
   - 分割窗口 (`:split`, `:vsplit`)
   - 窗口导航 (`<C-h/j/k/l>`)

4. **第四天**：LSP 功能
   - 跳转定义 (`<leader>ld`)
   - 查看文档 (`<leader>lh`)
   - 代码操作 (`<leader>lc`)

5. **第五天**：高级功能
   - 快速跳转 (`s`, `S`)
   - 文本环绕 (`ys`, `ds`, `cs`)
   - 搜索替换 (`:GrugFar`)

### 练习技巧

1. **vimtutor** - Vim 内置教程
   ```bash
   vimtutor
   ```

2. **实践项目** - 在实际项目中使用
3. **渐进学习** - 每天学习 1-2 个新功能
4. **肌肉记忆** - 重复练习快捷键

---

## 💡 提示

- 使用 `<leader>?` 可以随时查看可用的快捷键
- 在任何插件窗口中按 `?` 或 `g?` 通常会显示帮助
- `:Telescope` 可以探索更多搜索功能
- `:Lazy` 可以管理插件（更新、清理等）
- `:Mason` 可以安装更多 LSP 服务器和工具
- `:checkhealth` 可以诊断配置问题

---

**享受高效的 Neovim 编辑体验！** ✨
